{{> header}}
				<div class="m-grid__item m-grid__item--fluid m-wrapper">

					<div class="m-content">
						{{#if error}}
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							</button>
							<strong>Oh snap!</strong> {{error}}
						</div>
						{{/if}}
            {{#if success}}
						<div class="alert alert-success alert-dismissible fade show" role="alert">
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							</button>
							<strong>Success!</strong> {{success}}
						</div>
						{{/if}}



             <div class="row">
							<div class="col-lg-3">

								<!--begin::Portlet-->
								<div class="m-portlet">
									<div class="m-portlet__head">
										<div class="m-portlet__head-caption">
											<div class="m-portlet__head-title">
												<span class="m-portlet__head-icon m--hide">
													<i class="la la-gear"></i>
												</span>
												<h3 class="m-portlet__head-text">
													BudgetWise Profile
												</h3>
											</div>
										</div>
									</div>

									<!--begin::Form-->
										<div class="m-portlet__body">
											<div class="m-form__section m-form__section--first">
												<div class="form-group m-form__group">
													<label for="example_input_full_name">Email:</label>
													<input type="email" disabled="" class="form-control m-input" value="{{user.email}}">
												</div>
												<div class="form-group m-form__group">
													<label>Username:</label>
													<input type="text" class="form-control m-input" value="{{user.username}}" disabled="">
												</div>
                        <div class="form-group m-form__group">
													<label>First Name:</label>
													<input type="text" class="form-control m-input" value="{{user.first_name}}" disabled="">
												</div>
                        <div class="form-group m-form__group">
													<label>Last Name:</label>
													<input type="text" class="form-control m-input" value="{{user.last_name}}" disabled="">
												</div>
                        <div class="form-group m-form__group">
													<label>Parental Username:</label>
													<input type="text" class="form-control m-input" value="{{user.parental_username}}" disabled="">
													<span class="m-form__help">If blank, no parental account exists for your BudgetWise profile</span>
												</div>
											</div>
										</div>

									<!--end::Form-->
								</div>

								<!--end::Portlet-->
							</div>



              <div class="col-lg-3">

								<!--begin::Portlet-->
								<div class="m-portlet">
									<div class="m-portlet__head">
										<div class="m-portlet__head-caption">
											<div class="m-portlet__head-title">
												<span class="m-portlet__head-icon m--hide">
													<i class="la la-gear"></i>
												</span>
												<h3 class="m-portlet__head-text">
													Edit BudgetWise Profile
												</h3>
											</div>
										</div>
									</div>

									<!--begin::Form-->
                  <form class="m-form" action="/settings" method="post">
										<div class="m-portlet__body">
											<div class="m-form__section m-form__section--first">
												<div class="form-group m-form__group">
													<label for="example_input_full_name">Email:</label>
													<input type="email" class="form-control m-input" name="email" value="{{user.email}}">
												</div>
                        <div class="form-group m-form__group">
													<label>Current Password</label>
													<input type="password" name="currentPassword" class="form-control m-input">
												</div>
                        <div class="form-group m-form__group">
													<label>New Password</label>
													<input type="password" name="newPassword" class="form-control m-input">
												</div>
                        <div class="form-group m-form__group">
													<label>Confirm New Password</label>
													<input type="password" name="newPassword2" class="form-control m-input">
												</div>
											</div>
										</div>
                    <div class="m-portlet__foot m-portlet__foot--fit">
											<div class="m-form__actions m-form__actions">
												<button type="submit" class="btn btn-primary">Submit</button>
												<button type="reset" class="btn btn-secondary">Reset</button>
											</div>
										</div>
                  </form>
									<!--end::Form-->
								</div>

								<!--end::Portlet-->
							</div>





              <div class="col-lg-3">

								<!--begin::Portlet-->
								<div class="m-portlet">
									<div class="m-portlet__head">
										<div class="m-portlet__head-caption">
											<div class="m-portlet__head-title">
												<span class="m-portlet__head-icon m--hide">
													<i class="la la-gear"></i>
												</span>
												<h3 class="m-portlet__head-text">
													Manage Parental Account
												</h3>
											</div>
										</div>
									</div>

									<!--begin::Form-->
                  <form class="m-form" action="/settings" method="post">
										<div class="m-portlet__body">
											<div class="m-form__section m-form__section--first">
												<div class="form-group m-form__group">
													<label for="example_input_full_name">Parent Email:</label>
													<input type="email" class="form-control m-input" name="email" value="{{user.parental_username}}">
												</div>
                        <div class="form-group m-form__group">
													<label>New Password</label>
													<input type="password" name="newPassword" class="form-control m-input">
												</div>
                        <div class="form-group m-form__group">
													<label>Confirm New Password</label>
													<input type="password" name="newPassword2" class="form-control m-input">
												</div>
											</div>
										</div>
                    <div class="m-portlet__foot m-portlet__foot--fit">
											<div class="m-form__actions m-form__actions">
												<button type="submit" class="btn btn-primary">Submit</button>
												<button type="reset" class="btn btn-secondary">Reset</button>
											</div>
										</div>
                  </form>
									<!--end::Form-->
								</div>

								<!--end::Portlet-->
							</div>


              <div class="col-lg-3">

								<!--begin::Portlet-->
								<div class="m-portlet">
									<div class="m-portlet__head">
										<div class="m-portlet__head-caption">
											<div class="m-portlet__head-title">
												<span class="m-portlet__head-icon m--hide">
													<i class="la la-gear"></i>
												</span>
												<h3 class="m-portlet__head-text">
													Manage Notifications
												</h3>
											</div>
										</div>
									</div>

									<!--begin::Form-->
                  <form class="m-form" action="/settings" method="post">
										<div class="m-portlet__body">
											<div class="m-form__section m-form__section--first">
												<label class="col-form-label">Notifications</label>
																<div>
																	<span class="m-switch m-switch--outline m-switch--icon m-switch--warning">
																		<label>
																			<input type="checkbox" name="notifications" {{#if user.notifications}}checked="checked"{{/if}}>
																			<span></span>
																		</label>
																	</span>
																</div>
                        <div class="form-group m-form__group">
													<label>Notification Frequency</label>
													<input type="number" name="notificationFrequency" class="form-control m-input" value="{{user.notification_frequency}}">
                          <span class="m-form__help">0 = daily | 1 = biweekly | 2 = monthly</span>
												</div>
											</div>
										</div>
                    <div class="m-portlet__foot m-portlet__foot--fit">
											<div class="m-form__actions m-form__actions">
												<button type="submit" class="btn btn-primary">Submit</button>
											</div>
										</div>
                  </form>
									<!--end::Form-->
								</div>

								<!--end::Portlet-->
							</div>




						</div>



						<!--End::Main Portlet-->
					</div>
				</div>
			{{> footer}}
<script>
function toggleClick() {
	if(document.getElementById("Div1").style.backgroundColor==="rgb(0, 115, 230)") {
		document.getElementById("Div1").style.backgroundColor="#ffffff";
	}
	else {
  	document.getElementById("Div1").style.backgroundColor="#0073e6";
	}
}
function deleteClick() {
	var result = confirm("Are you sure you want to delete your account?");
}
function changeCurrency() {
	let dbInfo = {
	  host: "localhost",
	  user: "root",
	  password: "BudgetWise1234!",
	  database : 'budgetwise'
	};
	let con = mysql.createConnection(dbInfo);
	let uID = req.user.identifier;
	con.query(`SELECT allowance, amountSpent, id FROM budgets WHERE user=@uID`, (error, results, fields) => {
		var i;
		for (i = 0; i < results.length; i++) {
			var newal = fixer(results[i].allowance);
			var newaS = fixer(results[i].amountSpent);
			var id = results[i].id;
			con.query(`UPDATE budgets SET allowance=@newal, amountSpent=@newaS WHERE id=@id `, (error, results, fields) => {

			}
		}
	}
	con.query(`SELECT price INTO @pr FROM expenses WHERE user=@uID`, (error, results, fields) => {
		var i;
		for (i = 0; i < results.length; i++) {
			var newpr = fixer(results[i].price);
			var id = results[i].id;
			con.query(`UPDATE expenses SET price=@newpr WHERE id=@id`, (error, results, fields) => {

			}
		}
	}
}
function fixer(num) {
	// set endpoint and your access key
endpoint = 'latest'
access_key = 'f434557b146d418db96f8949f9878a85';
base = 'USD';
symbols = 'CAD';

con.query(`SELECT currency FROM Settings WHERE user=@uID`, (error, results, fields) => {
	base = results[0].currency;
}
if(base === 'USD') {
	symbols = 'CAD';
}
else {
	symbols = 'USD';
}

// get the most recent exchange rates via the "latest" endpoint:
$.ajax({
    url: 'http://data.fixer.io/api/' + endpoint + '?access_key=' + access_key + '&base=' + base + '&symbols=' + symbols,
    dataType: 'jsonp',
    success: function(json) {

        // exchange rata data is stored in json.rates
        alert(json.rates.CAD);

        // base currency is stored in json.base
        alert(json.base);

        // timestamp can be accessed in json.timestamp
        alert(json.timestamp);

				con.query(`UPDATE Settings SET currency=@symbols WHERE user=@uID`, (error, results, fields) => {

				}

				return num * json.rates.CAD;
    }
		error: function(){
			alert('error');
    	return num;
  }
});
}
</script>
